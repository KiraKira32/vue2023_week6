import{_ as b,o,c as r,a as _,d as t,F as h,f as p,g,t as d,h as f,v}from"./index-6b7be36b.js";const{VITE_APP_URL:c,VITE_APP_PATH:i}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"asher_api",BASE_URL:"/vue2023_week6",MODE:"production",DEV:!1,PROD:!0},P={data(){return{products:[],productId:"",cart:{carts:[]},cartStatus:!1,loadingItem:"",loadingStatus:{isLoading:""},user:{},message:""}},methods:{getCarts(){this.$http.get(`${c}/v2/api/${i}/cart`).then(e=>{this.cart=e.data.data,this.cart.carts===0?this.cartStatus=!1:this.cartStatus=!0}).catch(e=>{alert(e.data.message)})},updataCartNum(e){const l={product_id:e.product.id,qty:e.qty};this.loadingItem=e.id,this.$http.put(`${c}/v2/api/${i}/cart/${e.id}`,{data:l}).then(m=>{alert("更新購物車成功"),this.getCarts(),this.loadingItem=""})},deleteProductNum(e){this.loadingItem=e.id,this.$http.delete(`${c}/v2/api/${i}/cart/${e.id}`).then(()=>{alert("刪除成功"),this.getCarts(),this.loadingItem=""})},deleteAllProduct(){this.$http.delete(`${c}/v2/api/${i}/carts`).then(e=>{alert("購物車已清空"),this.getCarts()}).catch(()=>{alert("請將商品加入購物車")})},isPhone(e){return/^(09)[0-9]{8}$/.test(e)?!0:"需要正確的電話號碼,範例: 0978197878"},onSubmit(){const e={user:{name:"test",email:"test@gmail.com",tel:"0912346768",address:"kaohsiung"},message:"這是留言"};if(this.cart.carts.length===0){alert("請先加商品加入購物車");return}this.$http.post(`${c}/v2/api/${i}/order`,{data:e}).then(()=>{alert("訂單建立成功"),this.$refs.form.resetForm(),this.message="",this.getCarts()}).catch(()=>{alert("error")})}},mounted(){this.getCarts()}},C={class:"text-end"},$=["disabled"],x={class:"table align-middle"},y=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),I=["disabled","onClick"],k={key:0,class:"fas fa-spinner fa-pulse"},V={class:"input-group input-group-sm"},A=["onUpdate:modelValue","disabled","onChange"],N=["value"],E={class:"text-end"},S=t("td",{colspan:"3",class:"text-end"},"總計",-1),T={class:"text-end"},D=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),L={class:"text-end text-success"};function U(e,l,m,q,a,u){return o(),r(h,null,[_(" 這是購物車頁面 "),t("div",C,[t("button",{class:"btn btn-outline-danger",type:"button",disabled:a.cart.carts.length===0,onClick:l[0]||(l[0]=s=>u.deleteAllProduct())},"清空購物車",8,$)]),t("table",x,[y,t("tbody",null,[a.cart.carts?(o(!0),r(h,{key:0},p(a.cart.carts,s=>(o(),r("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.id===a.loadingItem,onClick:n=>u.deleteProductNum(s)},[a.loadingItem===s.id?(o(),r("i",k)):g("",!0),_(" 刪除 ")],8,I)]),t("td",null,d(s.product.title),1),t("td",null,[t("div",V,[f(t("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":n=>s.qty=n,disabled:s.id===a.loadingItem,onChange:n=>u.updataCartNum(s)},[(o(),r(h,null,p(10,n=>t("option",{value:n,key:n+12344},d(n),9,N)),64))],40,A),[[v,s.qty]])])]),t("td",E,d(s.total),1)]))),128)):g("",!0)]),t("tfoot",null,[t("tr",null,[S,t("td",T,d(a.cart.total),1)]),t("tr",null,[D,t("td",L,d(a.cart.final_total),1)])])])],64)}const B=b(P,[["render",U]]);export{B as default};
